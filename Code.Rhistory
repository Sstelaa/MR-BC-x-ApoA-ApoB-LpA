library(TwoSampleMR)
library(MRInstruments)
library(ieugwasr)
library(devtools)
Sys.setenv(OPENGWAS_JWT = "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFwaS1qd3QiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhcGkub3Blbmd3YXMuaW8iLCJhdWQiOiJhcGkub3Blbmd3YXMuaW8iLCJzdWIiOiJ2aWxoYXIuc0BnbWFpbC5jb20iLCJpYXQiOjE3MTc0Mjg4MDIsImV4cCI6MTcxODYzODQwMn0.pVFcGa8QLK6u_KVaQpZpgcWnzUel1jGGPaIdQRTYQQQLMFOeCKXoQG6JvmlUQv-dbv336faik2yM2bFqs8sDYn7i_wLmWOmKrePWZmCtfyMlQrSg-lOGhQg60-3XpEyLc2S42_ylqJipKmESSqLFnyExVwjieno1vtKj-NzytgOG2vxMAVJN_8hpMNa6TlySjtnN8sdrHXBat2uO_5AxP_IxG8fkydfEteRQToCnNWM2Or3bapIyZBA9F2o6UDsoKYamqssWy5OQOcbvXD3gq2QGMsUdzfivQYqM90MXTql7da9lEYKPtb2BoLKY7Xnz2o21syvAlRIsG2tcutg8hQ")
exposure_gwas <- gwas_catalog
exposure_gwas <- subset(gwas_catalog, grepl("African", Initial_sample_description) & Phenotype_simple == "Breast cancer")
exposure_data <- format_data(exposure_gwas_bc_aa)
exposure_data <- format_data(exposure_gwas)
exposure_data <- clump_data(exposure_data, clump_r2 = 0.001, pop = "AFR")
ao <- available_outcomes()
outcome_data_ApoA <- extract_outcome_data(snps = exposure_data$SNP, outcomes = "ukb-e-30630_AFR")
outcome_data_ApoB <- extract_outcome_data(snps = exposure_data$SNP, outcomes = "ukb-e-30640_AFR")
outcome_data_LpA <- extract_outcome_data(snps = exposure_data$SNP, outcomes = "ukb-e-30790_AFR")
View(outcome_data_ApoA)
View(outcome_data_ApoB)
View(outcome_data_LpA)
h_data_ApoA <- harmonise_data(exposure_dat = exposure_data, outcome_dat = outcome_data_ApoA)
h_data_ApoB <- harmonise_data(exposure_dat = exposure_data, outcome_dat = outcome_data_ApoB)
h_data_LpA <- harmonise_data(exposure_dat = exposure_data, outcome_dat = outcome_data_LpA)
mr_results_ApoA <- mr(h_data_ApoA)
mr_results_ApoB <- mr(h_data_ApoB)
mr_results_LpA <- mr(h_data_LpA)
View(mr_results_ApoA)
View(mr_results_ApoB)
View(mr_results_LpA)
pleiotropy_ApoA <- mr_pleiotropy_test(h_data_ApoA)
pleiotropy_ApoB <- mr_pleiotropy_test(h_data_ApoB)
pleiotropy_LpA <- mr_pleiotropy_test(h_data_LpA)
View(pleiotropy_ApoA)
View(pleiotropy_ApoB)
View(pleiotropy_LpA)
heterogeneity_ApoA <- mr_heterogeneity(h_data_ApoA, method_list = c("mr_egger_regression", "mr_ivw"))
heterogeneity_ApoB <- mr_heterogeneity(h_data_ApoB, method_list = c("mr_egger_regression", "mr_ivw"))
heterogeneity_LpA <- mr_heterogeneity(h_data_LpA, method_list = c("mr_egger_regression", "mr_ivw"))
View(heterogeneity_ApoA)
View(heterogeneity_ApoB)
View(heterogeneity_LpA)
scatter_plot_ApoA <- mr_scatter_plot(mr_results_ApoA, h_data_ApoA)
scatter_plot_ApoB <- mr_scatter_plot(mr_results_ApoB, h_data_ApoB)
scatter_plot_LpA <- mr_scatter_plot(mr_results_LpA, h_data_LpA)
scatter_plot_ApoA
scatter_plot_ApoB
scatter_plot_LpA
res_single_ApoA <- mr_singlesnp(h_data_ApoA)
res_single_ApoB <- mr_singlesnp(h_data_ApoB)
res_single_LpA <- mr_singlesnp(h_data_LpA)
forrest_plot_ApoA <- mr_forest_plot(res_single_ApoA)
forrest_plot_ApoB <- mr_forest_plot(res_single_ApoB)
forrest_plot_LpA <- mr_forest_plot(res_single_LpA)
forrest_plot_ApoA
forrest_plot_ApoB
forrest_plot_LpA
funnel_plot_ApoA <- mr_funnel_plot(res_single_ApoA)
funnel_plot_ApoB <- mr_funnel_plot(res_single_ApoB)
funnel_plot_LpA <- mr_funnel_plot(res_single_LpA)
funnel_plot_ApoA
funnel_plot_ApoB
funnel_plot_LpA
library(writexl)
write_xlsx(exposure_data, path = "exposure_data.xlsx")
write_xlsx(outcome_data_ApoA, path = "outcome_data_ApoA.xlsx")
write_xlsx(outcome_data_ApoB, path = "outcome_data_ApoB.xlsx")
write_xlsx(outcome_data_LpA, path = "outcome_data_LpA.xlsx")
write_xlsx(h_data_ApoA, path = "harmonised_data_for_analyses_ApoA.xlsx")
write_xlsx(h_data_ApoB, path = "harmonised_data_for_analyses_ApoB.xlsx")
write_xlsx(h_data_LpA, path = "harmonised_data_for_analyses_LpA.xlsx")
write_xlsx(mr_results_ApoA, path = "mr_results_ApoA.xlsx")
write_xlsx(mr_results_ApoB, path = "mr_results_ApoB.xlsx")
write_xlsx(mr_results_LpA, path = "mr_results_LpA.xlsx")
write_xlsx(heterogeneity_ApoA, path = "heterogeneity_results_ApoA.xlsx")
write_xlsx(heterogeneity_ApoB, path = "heterogeneity_results_ApoB.xlsx")
write_xlsx(heterogeneity_LpA, path = "heterogeneity_results_LpA.xlsx")
write_xlsx(pleiotropy_LpA, path = "pleiotropy_results_LpA.xlsx")
write_xlsx(pleiotropy_ApoA, path = "pleiotropy_results_ApoA.xlsx")
write_xlsx(pleiotropy_ApoB, path = "pleiotropy_results_ApoB.xlsx")
savehistory("~/Desktop/Mendelian Randomisation/MR BC x ApoA ApoB LpA [African American Afro Caribbean Males&females]/MR BCxApoA; ApoB; LpA [African American + Carribean]/Code.Rhistory")
